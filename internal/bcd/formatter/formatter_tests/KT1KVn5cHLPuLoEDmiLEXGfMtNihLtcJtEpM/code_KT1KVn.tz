parameter (or :_entries (option %_Liq_entry_main nat) (or (pair %_Liq_entry_transfer address nat) (or (pair %_Liq_entry_approve address nat) (or (pair %_Liq_entry_transferFrom address (pair address nat)) (or (pair %_Liq_entry_balanceOf address (contract :NatContract nat)) (or (pair %_Liq_entry_allowance address (pair address (contract :NatNatContract (pair nat nat)))) (or (pair %_Liq_entry_createAccount address nat) (list %_Liq_entry_createAccounts (pair address nat)))))))));
storage (pair :storage (map %accounts address (pair :account (nat %balance) (map %allowances address nat))) (pair (nat %version) (pair (nat %totalSupply) (pair (nat %decimals) (pair (string %name) (pair (string %symbol) (address %owner)))))));
code { DUP ;
       DIP { CDR @storage_slash_1 } ;
       CAR @parameter_slash_2 ;
       LAMBDA @get_account (pair address (map address (pair :account (nat %balance) (map %allowances address nat)))) (pair :account (nat %balance) (map %allowances address nat)) { RENAME @_a_accounts_slash_3 ; DUP ; CDR @accounts ; { DIP { DUP } ; SWAP } ; CAR @a ; GET ; IF_NONE { PUSH (map address nat) {} ; PUSH nat 0 ; PAIR %balance %allowances } {} ; DIP { DROP } } ;
       DUP @get_account ;
       LAMBDA (pair (pair address (pair address (pair nat (pair :storage (map %accounts address (pair :account (nat %balance) (map %allowances address nat))) (pair (nat %version) (pair (nat %totalSupply) (pair (nat %decimals) (pair (string %name) (pair (string %symbol) (address %owner)))))))))) (lambda (pair address (map address (pair :account (nat %balance) (map %allowances address nat)))) (pair :account (nat %balance) (map %allowances address nat)))) (pair (list operation) (pair :storage (map %accounts address (pair :account (nat %balance) (map %allowances address nat))) (pair (nat %version) (pair (nat %totalSupply) (pair (nat %decimals) (pair (string %name) (pair (string %symbol) (address %owner)))))))) { RENAME @closure_env_slash_8 ; DUP ; CAR ; CAR @from ; { DIP { DUP } ; SWAP } ; CAR ; { CDR ; CAR @dest } ; { DIP { { DIP { DUP } ; SWAP } } ; SWAP } ; CAR ; { CDR ; CDR ; CAR @tokens } ; { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ; CAR ; { CDR ; CDR ; CDR @storage } ; DUP @storage ; CAR @accounts %accounts ; { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; CDR @get_account_slash_7 ; { DIP { DUP @accounts } ; SWAP } ; { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; PAIR ; EXEC @account_sender ; { DIP { DUP @accounts } ; SWAP } ; { DIP { { DIP { { DIP { { DIP { DUP @tokens } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; { DIP { { DIP { DUP @account_sender } ; SWAP } } ; SWAP } ; CAR %balance ; SUB ; ISNAT ; IF_NONE { { DIP { DUP @account_sender } ; SWAP } ;
                 CAR %balance ;
                 PUSH string "Not enough tokens for transfer" ;
                 PAIR ;
                 FAILWITH }
               { { DIP { { DIP { DUP @account_sender } ; SWAP } } ; SWAP } ;
                 CDR %allowances ;
                 SWAP ;
                 PAIR %balance %allowances } ; RENAME @new_account_sender ; { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; DIP { SOME } ; UPDATE @accounts ; { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; CDR @get_account_slash_7 ; { DIP { DUP @accounts } ; SWAP } ; { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @dest } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; PAIR ; EXEC @account_dest ; { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; CDR ; { DIP { { DIP { DUP @accounts } ; SWAP } } ; SWAP } ; { DIP { { DIP { DUP @account_dest } ; SWAP } } ; SWAP } ; CDR %allowances ; { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @tokens } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; { DIP { { DIP { { DIP { { DIP { DUP @account_dest } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; CAR %balance ; ADD ; PAIR @new_account_dest %balance %allowances ; { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @dest } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; DIP { SOME } ; DIP { DIP { DIP { DIP { DROP ; DROP ; DROP ; DROP ; DROP ; DROP ; DROP ; DROP ; DROP } } } } ; UPDATE @accounts ; PAIR %accounts ; NIL operation ; PAIR } ;
       PAIR @perform_transfer ;
       { DIP { { DIP { DUP @parameter } ; SWAP } } ; SWAP } ;
       IF_LEFT { DROP ;
                 { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ;
                 NIL operation ;
                 PAIR }
               { IF_LEFT { RENAME @_dest_tokens_slash_25 ;
                           { DIP { DUP @perform_transfer } ; SWAP } ;
                           { DIP { { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                           { DIP { { DIP { DUP } ; SWAP } } ; SWAP } ;
                           CDR @tokens ;
                           PAIR ;
                           { DIP { { DIP { DUP } ; SWAP } } ; SWAP } ;
                           CAR @dest ;
                           PAIR ;
                           SENDER ;
                           PAIR ;
                           DIP { DUP ; CAR ; SWAP ; CDR } ;
                           DIP { DIP { DIP { DROP } } } ;
                           PAIR ;
                           EXEC }
                         { IF_LEFT { RENAME @_spender_tokens_slash_29 ;
                                     { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     { DIP { DUP } ; SWAP } ;
                                     CAR @spender ;
                                     { DIP { { DIP { DUP } ; SWAP } } ; SWAP } ;
                                     CDR @tokens ;
                                     { DIP { { DIP { { DIP { { DIP { { DIP { DUP @get_account } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     CAR %accounts ;
                                     SENDER ;
                                     PAIR ;
                                     EXEC @account_sender ;
                                     { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     CDR ;
                                     { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     CAR %accounts ;
                                     { DIP { { DIP { DUP @account_sender } ; SWAP } } ; SWAP } ;
                                     CAR %balance ;
                                     PUSH nat 0 ;
                                     { DIP { { DIP { { DIP { { DIP { { DIP { DUP @tokens } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     EQ ;
                                     IF { { DIP { { DIP { { DIP { DUP @account_sender } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          CDR %allowances ;
                                          { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @spender } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          DIP { NONE nat } ;
                                          UPDATE }
                                        { { DIP { { DIP { { DIP { DUP @account_sender } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          CDR %allowances ;
                                          { DIP { { DIP { { DIP { { DIP { { DIP { DUP @tokens } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @spender } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          DIP { SOME } ;
                                          UPDATE } ;
                                     SWAP ;
                                     PAIR @account_sender %balance %allowances ;
                                     SENDER ;
                                     DIP { SOME } ;
                                     DIP { DIP { DIP { DIP { DROP ; DROP ; DROP ; DROP ; DROP } } } } ;
                                     UPDATE ;
                                     PAIR @storage %accounts ;
                                     NIL operation ;
                                     PAIR }
                                   { IF_LEFT { RENAME @_from_dest_tokens_slash_36 ;
                                               { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               { DIP { DUP } ; SWAP } ;
                                               CAR @from ;
                                               { DIP { { DIP { DUP } ; SWAP } } ; SWAP } ;
                                               { CDR ; CDR @tokens } ;
                                               { DIP { { DIP { { DIP { { DIP { { DIP { DUP @get_account } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               CAR %accounts ;
                                               { DIP { { DIP { { DIP { DUP @from } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               PAIR ;
                                               EXEC @account_from ;
                                               { DIP { { DIP { { DIP { { DIP { { DIP { DUP @perform_transfer } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               CDR ;
                                               { DIP { { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               CAR %accounts ;
                                               { DIP { { DIP { { DIP { DUP @account_from } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               CAR %balance ;
                                               { DIP { { DIP { { DIP { { DIP { DUP @account_from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               CDR %allowances ;
                                               SENDER ;
                                               GET ;
                                               IF_NONE { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         PUSH string "Not allowed to spend from" ;
                                                         PAIR ;
                                                         FAILWITH }
                                                       { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @tokens } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         { DIP { DUP @allowed } ; SWAP } ;
                                                         SUB ;
                                                         ISNAT ;
                                                         IF_NONE { DUP @allowed ;
                                                                   PUSH string "Not enough allowance for transfer" ;
                                                                   PAIR ;
                                                                   FAILWITH }
                                                                 { PUSH nat 0 ;
                                                                   { DIP { DUP @allowed } ; SWAP } ;
                                                                   COMPARE ;
                                                                   EQ ;
                                                                   IF { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @account_from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        CDR %allowances ;
                                                                        SENDER ;
                                                                        DIP { NONE nat } ;
                                                                        UPDATE }
                                                                      { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @account_from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        CDR %allowances ;
                                                                        { DIP { DUP @allowed } ; SWAP } ;
                                                                        SENDER ;
                                                                        DIP { SOME } ;
                                                                        UPDATE } ;
                                                                   DIP { DROP } } ;
                                                         DIP { DROP } } ;
                                               RENAME @new_allowances_from ;
                                               SWAP ;
                                               PAIR @account_from %balance %allowances ;
                                               { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               DIP { SOME } ;
                                               UPDATE ;
                                               PAIR @storage %accounts ;
                                               { DIP { { DIP { { DIP { DUP @tokens } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               PAIR ;
                                               { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               { CDR ; CAR @dest } ;
                                               PAIR ;
                                               { DIP { { DIP { { DIP { { DIP { DUP @from } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                               PAIR ;
                                               DIP { DUP ; CAR ; SWAP ; CDR } ;
                                               DIP { DIP { DIP { DROP ; DROP ; DROP ; DROP ; DROP } } } ;
                                               PAIR ;
                                               EXEC }
                                             { IF_LEFT { RENAME @_spender_forward_slash_47 ;
                                                         { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         DUP @storage ;
                                                         NIL operation ;
                                                         { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         CDR @forward ;
                                                         PUSH mumav 0 ;
                                                         { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         CAR %accounts ;
                                                         { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         CAR @spender ;
                                                         GET ;
                                                         IF_NONE { PUSH nat 0 }
                                                                 { CAR %balance } ;
                                                         DIP { DIP { DIP { DIP { DIP { DROP ; DROP } } } } } ;
                                                         RENAME @spender_balance ;
                                                         TRANSFER_TOKENS ;
                                                         CONS ;
                                                         PAIR }
                                                       { IF_LEFT { RENAME @_from_spender_forward_slash_53 ;
                                                                   { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   DUP @storage ;
                                                                   NIL operation ;
                                                                   { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   { CDR ; CDR @forward } ;
                                                                   PUSH mumav 0 ;
                                                                   { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   CAR %accounts ;
                                                                   { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   CAR @from ;
                                                                   GET ;
                                                                   IF_NONE { PUSH (pair nat nat) (Pair 0 0) }
                                                                           { DUP @account ;
                                                                             CDR %allowances ;
                                                                             { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             { CDR ; CAR @spender } ;
                                                                             GET ;
                                                                             IF_NONE { DUP @account ;
                                                                                       CAR %balance ;
                                                                                       PUSH nat 0 ;
                                                                                       PAIR }
                                                                                     { { DIP { DUP @account } ; SWAP } ;
                                                                                       CAR %balance ;
                                                                                       SWAP ;
                                                                                       PAIR } ;
                                                                             DIP { DROP } } ;
                                                                   DIP { DIP { DIP { DIP { DIP { DROP ; DROP } } } } } ;
                                                                   RENAME @spender_allowance ;
                                                                   TRANSFER_TOKENS ;
                                                                   CONS ;
                                                                   PAIR }
                                                                 { IF_LEFT { RENAME @_dest_tokens_slash_61 ;
                                                                             { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             DUP @storage ;
                                                                             { CDR ; CDR ; CDR ; CDR ; CDR ; CDR %owner } ;
                                                                             SENDER ;
                                                                             COMPARE ;
                                                                             NEQ ;
                                                                             IF { PUSH string "Only owner can create accounts" ;
                                                                                  FAILWITH }
                                                                                { UNIT } ;
                                                                             DROP ;
                                                                             { DIP { { DIP { DUP @perform_transfer } ; SWAP } } ; SWAP } ;
                                                                             { DIP { DUP @storage } ; SWAP } ;
                                                                             { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             CDR @tokens ;
                                                                             PAIR ;
                                                                             { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             CAR @dest ;
                                                                             PAIR ;
                                                                             { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                                                                             { CDR ; CDR ; CDR ; CDR ; CDR ; CDR %owner } ;
                                                                             PAIR ;
                                                                             DIP { DUP ; CAR ; SWAP ; CDR } ;
                                                                             DIP { DIP { DIP { DROP ; DROP } } } ;
                                                                             PAIR ;
                                                                             EXEC }
                                                                           { RENAME @new_accounts_slash_65 ;
                                                                             { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             DUP @storage ;
                                                                             { CDR ; CDR ; CDR ; CDR ; CDR ; CDR %owner } ;
                                                                             SENDER ;
                                                                             COMPARE ;
                                                                             NEQ ;
                                                                             IF { PUSH string "Only owner can create accounts" ;
                                                                                  FAILWITH }
                                                                                { UNIT } ;
                                                                             DROP ;
                                                                             DUP @storage ;
                                                                             NIL operation ;
                                                                             PAIR ;
                                                                             { DIP { { DIP { DUP @new_accounts } ; SWAP } } ; SWAP } ;
                                                                             ITER { RENAME @_dest_tokens__ops_storage_slash_67 ; DIP { DUP } ; PAIR ; DUP ; CDR ; CDR @storage ; { DIP { { DIP { { DIP { { DIP { { DIP { DUP @perform_transfer } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; { DIP { DUP @storage } ; SWAP } ; { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ; CAR ; CDR @tokens ; PAIR ; { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } ; CAR ; CAR @dest ; PAIR ; { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ; { CDR ; CDR ; CDR ; CDR ; CDR ; CDR %owner } ; PAIR ; DIP { DUP ; CAR ; SWAP ; CDR } ; DIP { DIP { DIP { DROP ; DROP ; DROP } } } ; PAIR ; EXEC } ;
                                                                             DIP { DROP ; DROP } } } } } } } } ;
       DIP { DROP ; DROP ; DROP ; DROP } }