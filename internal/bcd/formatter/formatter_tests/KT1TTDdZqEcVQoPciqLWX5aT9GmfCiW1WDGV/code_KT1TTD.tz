parameter (or :_entries (unit %_Liq_entry_outbid) (or (mumav %_Liq_entry_withdraw) (or (nat %_Liq_entry_main) (or (pair %_Liq_entry_finish bytes bytes) (or (pair %_Liq_entry_reset bytes bool) (unit %_Liq_entry_fund))))));
storage (pair :storage (option %game (pair :game (nat %betn) (pair (mumav %bet) (pair (address %player) (pair (timestamp %time) (mumav %win_amount)))))) (pair (bytes %next_win_number) (pair (address %owner) (pair (timestamp %owner_started) (bool %oracle_for_all_bets)))));
code { DUP ;
       DIP { CDR @storage_slash_1 } ;
       CAR @parameter_slash_2 ;
       DUP @parameter ;
       IF_LEFT { RENAME @__slash_20 ;
                 { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                 SENDER @new_owner ;
                 { DIP { DUP @storage } ; SWAP } ;
                 { CDR ; CDR ; CAR %owner } ;
                 { DIP { DUP @new_owner } ; SWAP } ;
                 COMPARE ;
                 NEQ ;
                 IF { PUSH mumav 100000000 ;
                      AMOUNT ;
                      COMPARE ;
                      LT ;
                      IF { PUSH string "Min contribution is 100tz" ;
                           FAILWITH }
                         { UNIT } ;
                      DROP ;
                      PUSH mumav 100000000 ;
                      AMOUNT ;
                      BALANCE ;
                      SUB ;
                      ADD ;
                      AMOUNT ;
                      COMPARE ;
                      LT ;
                      IF { PUSH string "Can't outbid" ;
                           FAILWITH }
                         { UNIT } ;
                      DROP ;
                      AMOUNT ;
                      BALANCE ;
                      SUB @amount_to_return ;
                      { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                      DUP ;
                      CAR %game ;
                      SWAP ;
                      CDR ;
                      DUP ;
                      CAR %next_win_number ;
                      SWAP ;
                      CDR ;
                      CDR ;
                      { DIP { { DIP { { DIP { { DIP { DUP @new_owner } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                      PAIR %owner ;
                      SWAP ;
                      PAIR %next_win_number ;
                      SWAP ;
                      PAIR @storage %game ;
                      PUSH mumav 0 ;
                      { DIP { { DIP { DUP @amount_to_return } ; SWAP } } ; SWAP } ;
                      COMPARE ;
                      GT ;
                      IF { NIL operation ;
                           { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                           { CDR ; CDR ; CAR %owner } ;
                           CONTRACT unit ;
                           IF_NONE { { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ; { CDR ; CDR ; CAR %owner } ; PUSH string "Cannot recover contract from:" ; PAIR ; FAILWITH } {} ;
                           RENAME @owner_inst ;
                           { DIP { { DIP { { DIP { DUP @amount_to_return } ; SWAP } } ; SWAP } } ; SWAP } ;
                           UNIT ;
                           TRANSFER_TOKENS ;
                           CONS }
                         { NIL operation } ;
                      DIP { DIP { DROP } } ;
                      RENAME @ops ;
                      PAIR }
                    { { DIP { DUP @storage } ; SWAP } ;
                      NIL operation ;
                      PAIR } ;
                 DIP { DROP ; DROP ; DROP } }
               { IF_LEFT { RENAME @amount_slash_28 ;
                           { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                           DUP @storage ;
                           { CDR ; CDR ; CAR %owner } ;
                           SENDER ;
                           COMPARE ;
                           NEQ ;
                           IF { PUSH string "Wrong owner" ;
                                FAILWITH }
                              { UNIT } ;
                           DROP ;
                           PUSH int 2678400 ;
                           { DIP { DUP @storage } ; SWAP } ;
                           { CDR ; CDR ; CDR ; CAR %owner_started } ;
                           NOW ;
                           SUB ;
                           COMPARE ;
                           LT ;
                           IF { PUSH string "Too early to withdraw" ;
                                FAILWITH }
                              { UNIT } ;
                           DROP ;
                           DUP @storage ;
                           CAR %game ;
                           IF_NONE { PUSH mumav 0 }
                                   { { CDR ; CDR ; CDR ; CDR %win_amount } } ;
                           RENAME @game_win ;
                           { DIP { DUP @storage } ; SWAP } ;
                           NIL operation ;
                           { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } ;
                           { CDR ; CDR ; CAR %owner } ;
                           CONTRACT unit ;
                           IF_NONE { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } ; { CDR ; CDR ; CAR %owner } ; PUSH string "Cannot recover contract from:" ; PAIR ; FAILWITH } {} ;
                           RENAME @owner_inst ;
                           { DIP { { DIP { { DIP { { DIP { { DIP { DUP @amount } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                           PUSH mumav 1000000 ;
                           { DIP { { DIP { { DIP { { DIP { { DIP { DUP @game_win } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                           BALANCE ;
                           SUB ;
                           SUB ;
                           COMPARE ;
                           LT ;
                           IF { PUSH mumav 1000000 ;
                                { DIP { { DIP { { DIP { { DIP { DUP @game_win } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                BALANCE ;
                                SUB ;
                                SUB }
                              { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @amount } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ;
                           DIP { DIP { DIP { DIP { DROP ; DROP ; DROP } } } } ;
                           RENAME @amount_to_withdraw ;
                           UNIT ;
                           TRANSFER_TOKENS ;
                           CONS ;
                           PAIR }
                         { IF_LEFT { RENAME @betn_slash_35 ;
                                     { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                                     PUSH nat 3023 ;
                                     { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     PUSH nat 3103 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 3120 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 3003 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 3020 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 3100 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 2002 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 2001 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 1002 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 1001 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     NEQ ;
                                     AND ;
                                     PUSH nat 36 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     GT ;
                                     AND ;
                                     IF { PUSH string "Incorrect game parameter" ;
                                          FAILWITH }
                                        { UNIT } ;
                                     DROP ;
                                     PUSH mumav 1000000 ;
                                     AMOUNT ;
                                     COMPARE ;
                                     LT ;
                                     IF { PUSH string "Min bet is 1tz" ;
                                          FAILWITH }
                                        { UNIT } ;
                                     DROP ;
                                     PUSH mumav 1000000000 ;
                                     AMOUNT ;
                                     COMPARE ;
                                     GT ;
                                     IF { PUSH string "Max bet is 1000tz" ;
                                          FAILWITH }
                                        { UNIT } ;
                                     DROP ;
                                     PUSH nat 37 ;
                                     { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     LT ;
                                     PUSH mumav 100000000 ;
                                     AMOUNT ;
                                     COMPARE ;
                                     GT ;
                                     AND ;
                                     IF { PUSH string "Max single number bet is 100tz" ;
                                          FAILWITH }
                                        { UNIT } ;
                                     DROP ;
                                     BALANCE ;
                                     PUSH mumav 10000000 ;
                                     PUSH nat 35 ;
                                     AMOUNT ;
                                     MUL ;
                                     ADD ;
                                     COMPARE ;
                                     GT ;
                                     PUSH nat 37 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     LT ;
                                     AND ;
                                     IF { PUSH string "Bet is too high for our balance" ;
                                          FAILWITH }
                                        { UNIT } ;
                                     DROP ;
                                     BALANCE ;
                                     PUSH mumav 10000000 ;
                                     PUSH nat 10 ;
                                     AMOUNT ;
                                     MUL ;
                                     ADD ;
                                     COMPARE ;
                                     GT ;
                                     PUSH nat 36 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     GT ;
                                     AND ;
                                     IF { PUSH string "Bet is too high for our balance" ;
                                          FAILWITH }
                                        { UNIT } ;
                                     DROP ;
                                     PUSH mumav 10000000 ;
                                     AMOUNT ;
                                     COMPARE ;
                                     GT ;
                                     PUSH nat 37 ;
                                     { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                     COMPARE ;
                                     LT ;
                                     PUSH mumav 1000000 ;
                                     AMOUNT ;
                                     COMPARE ;
                                     GT ;
                                     AND ;
                                     OR ;
                                     PUSH bool True ;
                                     { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                                     { CDR ; CDR ; CDR ; CDR %oracle_for_all_bets } ;
                                     COMPARE ;
                                     EQ ;
                                     OR ;
                                     IF { DUP @storage ;
                                          CAR %game ;
                                          IF_NONE { DUP @storage ;
                                                    CDR ;
                                                    PUSH nat 37 ;
                                                    { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    COMPARE ;
                                                    LT ;
                                                    IF { PUSH nat 35 ;
                                                         AMOUNT ;
                                                         MUL }
                                                       { PUSH nat 3000 ;
                                                         { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         LT ;
                                                         IF { PUSH nat 2 ;
                                                              AMOUNT ;
                                                              MUL }
                                                            { PUSH nat 3003 ;
                                                              { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              EQ ;
                                                              PUSH nat 3020 ;
                                                              { DIP { { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              EQ ;
                                                              OR ;
                                                              PUSH nat 3100 ;
                                                              { DIP { { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              EQ ;
                                                              OR ;
                                                              IF { PUSH nat 3 ;
                                                                   AMOUNT ;
                                                                   MUL }
                                                                 { PUSH nat 2 ;
                                                                   AMOUNT ;
                                                                   EDIV ;
                                                                   IF_NONE { UNIT ;
                                                                             FAILWITH }
                                                                           { CAR @r } ;
                                                                   RENAME @x ;
                                                                   AMOUNT ;
                                                                   ADD } } } ;
                                                    RENAME @win_amount ;
                                                    NOW @time ;
                                                    PAIR %time %win_amount ;
                                                    SENDER @player ;
                                                    PAIR %player ;
                                                    AMOUNT @bet ;
                                                    PAIR %bet ;
                                                    { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    PAIR %betn ;
                                                    SOME ;
                                                    PAIR @storage %game ;
                                                    NIL operation ;
                                                    PAIR }
                                                  { DUP @g ;
                                                    PUSH string "Game already started with" ;
                                                    PAIR ;
                                                    FAILWITH } }
                                        { PUSH nat 36 ;
                                          { DIP { DUP @storage } ; SWAP } ;
                                          { CDR ; CDR ; CDR ; CAR %owner_started } ;
                                          NOW ;
                                          SUB @t ;
                                          EDIV ;
                                          IF_NONE { UNIT ;
                                                    FAILWITH }
                                                  { CDR @r } ;
                                          RENAME @win_n ;
                                          { DIP { DUP @storage } ; SWAP } ;
                                          NIL operation ;
                                          SENDER ;
                                          CONTRACT unit ;
                                          IF_NONE { SENDER ; PUSH string "Cannot recover contract from:" ; PAIR ; FAILWITH } {} ;
                                          RENAME @pi ;
                                          PUSH mumav 1 ;
                                          { DIP { { DIP { { DIP { { DIP { DUP @win_n } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          MUL ;
                                          AMOUNT ;
                                          { DIP { { DIP { { DIP { { DIP { { DIP { DUP @win_n } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          PAIR ;
                                          { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @betn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          PAIR ;
                                          DUP ;
                                          CAR @bn ;
                                          { DIP { DUP } ; SWAP } ;
                                          { CDR ; CAR @wn } ;
                                          { DIP { { DIP { DUP } ; SWAP } } ; SWAP } ;
                                          { CDR ; CDR @bet } ;
                                          { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } ;
                                          { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                          COMPARE ;
                                          EQ ;
                                          PUSH nat 37 ;
                                          { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                          COMPARE ;
                                          LT ;
                                          AND ;
                                          IF { PUSH nat 35 ;
                                               { DIP { DUP @bet } ; SWAP } ;
                                               MUL }
                                             { PUSH nat 36 ;
                                               { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                               COMPARE ;
                                               GT ;
                                               IF { PUSH mumav 0 }
                                                  { PUSH nat 18 ;
                                                    { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                    COMPARE ;
                                                    GT ;
                                                    PUSH nat 2002 ;
                                                    { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    COMPARE ;
                                                    EQ ;
                                                    AND ;
                                                    PUSH nat 19 ;
                                                    { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    COMPARE ;
                                                    LT ;
                                                    PUSH nat 2001 ;
                                                    { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    COMPARE ;
                                                    EQ ;
                                                    AND ;
                                                    OR ;
                                                    PUSH nat 0 ;
                                                    PUSH nat 2 ;
                                                    { DIP { { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    EDIV ;
                                                    IF_NONE { UNIT ;
                                                              FAILWITH }
                                                            { CDR @r } ;
                                                    RENAME @x ;
                                                    COMPARE ;
                                                    EQ ;
                                                    PUSH nat 1002 ;
                                                    { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    COMPARE ;
                                                    EQ ;
                                                    AND ;
                                                    OR ;
                                                    PUSH nat 1 ;
                                                    PUSH nat 2 ;
                                                    { DIP { { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    EDIV ;
                                                    IF_NONE { UNIT ;
                                                              FAILWITH }
                                                            { CDR @r } ;
                                                    RENAME @x ;
                                                    COMPARE ;
                                                    EQ ;
                                                    PUSH nat 1001 ;
                                                    { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                    COMPARE ;
                                                    EQ ;
                                                    AND ;
                                                    OR ;
                                                    IF { PUSH nat 2 ;
                                                         { DIP { DUP @bet } ; SWAP } ;
                                                         MUL }
                                                       { PUSH nat 24 ;
                                                         { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         GT ;
                                                         PUSH nat 3003 ;
                                                         { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         EQ ;
                                                         AND ;
                                                         PUSH nat 25 ;
                                                         { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         LT ;
                                                         PUSH nat 12 ;
                                                         { DIP { { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         GT ;
                                                         AND ;
                                                         PUSH nat 3020 ;
                                                         { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         EQ ;
                                                         AND ;
                                                         OR ;
                                                         PUSH nat 13 ;
                                                         { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         LT ;
                                                         PUSH nat 3100 ;
                                                         { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         EQ ;
                                                         AND ;
                                                         OR ;
                                                         IF { PUSH nat 3 ;
                                                              { DIP { DUP @bet } ; SWAP } ;
                                                              MUL }
                                                            { PUSH nat 24 ;
                                                              { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              GT ;
                                                              PUSH nat 13 ;
                                                              { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              LT ;
                                                              OR ;
                                                              PUSH nat 3103 ;
                                                              { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              EQ ;
                                                              AND ;
                                                              PUSH nat 12 ;
                                                              { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              GT ;
                                                              PUSH nat 3023 ;
                                                              { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              EQ ;
                                                              AND ;
                                                              OR ;
                                                              PUSH nat 25 ;
                                                              { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              LT ;
                                                              PUSH nat 3120 ;
                                                              { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              EQ ;
                                                              AND ;
                                                              OR ;
                                                              IF { PUSH mumav 1000000 ;
                                                                   PUSH nat 2 ;
                                                                   { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   EDIV ;
                                                                   IF_NONE { UNIT ;
                                                                             FAILWITH }
                                                                           { CAR @r } ;
                                                                   RENAME @x ;
                                                                   MUL ;
                                                                   { DIP { DUP @bet } ; SWAP } ;
                                                                   ADD }
                                                                 { PUSH mumav 0 } } } } } ;
                                          DIP { DROP ; DROP ; DROP ; DROP } ;
                                          DIP { DIP { DIP { DIP { DIP { DROP } } } } } ;
                                          ADD ;
                                          UNIT ;
                                          TRANSFER_TOKENS ;
                                          CONS ;
                                          PAIR } ;
                                     DIP { DROP ; DROP } }
                                   { IF_LEFT { RENAME @_oracle_hash_next_win_hash_slash_56 ;
                                               { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                                               { DIP { DUP } ; SWAP } ;
                                               CAR @oracle_hash ;
                                               { DIP { DUP @storage } ; SWAP } ;
                                               CAR %game ;
                                               IF_NONE { PUSH string "No game started" ;
                                                         FAILWITH }
                                                       { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                                                         { CDR ; CAR %next_win_number } ;
                                                         { DIP { { DIP { DUP @oracle_hash } ; SWAP } } ; SWAP } ;
                                                         SHA512 @decrypted_hash ;
                                                         COMPARE ;
                                                         NEQ ;
                                                         IF { PUSH string "incorrect hash" ;
                                                              FAILWITH }
                                                            { UNIT } ;
                                                         DROP ;
                                                         { DIP { DUP @oracle_hash } ; SWAP } ;
                                                         UNPACK @t (pair nat bytes) ;
                                                         IF_NONE { PUSH string "bad unpack" ;
                                                                   FAILWITH }
                                                                 { CAR } ;
                                                         RENAME @win_number ;
                                                         PUSH nat 36 ;
                                                         { DIP { DUP @win_number } ; SWAP } ;
                                                         COMPARE ;
                                                         GT ;
                                                         IF { PUSH string "incorrect number" ;
                                                              FAILWITH }
                                                            { UNIT } ;
                                                         DROP ;
                                                         { DIP { DUP @game } ; SWAP } ;
                                                         { CDR ; CAR %bet } ;
                                                         { DIP { DUP @win_number } ; SWAP } ;
                                                         PAIR ;
                                                         { DIP { { DIP { DUP @game } ; SWAP } } ; SWAP } ;
                                                         CAR %betn ;
                                                         PAIR ;
                                                         DUP ;
                                                         CAR @bn ;
                                                         { DIP { DUP } ; SWAP } ;
                                                         { CDR ; CAR @wn } ;
                                                         { DIP { { DIP { DUP } ; SWAP } } ; SWAP } ;
                                                         { CDR ; CDR @bet } ;
                                                         { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } ;
                                                         { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         EQ ;
                                                         PUSH nat 37 ;
                                                         { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         LT ;
                                                         AND ;
                                                         IF { PUSH nat 35 ;
                                                              { DIP { DUP @bet } ; SWAP } ;
                                                              MUL }
                                                            { PUSH nat 36 ;
                                                              { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                              COMPARE ;
                                                              GT ;
                                                              IF { PUSH mumav 0 }
                                                                 { PUSH nat 18 ;
                                                                   { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                                   COMPARE ;
                                                                   GT ;
                                                                   PUSH nat 2002 ;
                                                                   { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   COMPARE ;
                                                                   EQ ;
                                                                   AND ;
                                                                   PUSH nat 19 ;
                                                                   { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   COMPARE ;
                                                                   LT ;
                                                                   PUSH nat 2001 ;
                                                                   { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   COMPARE ;
                                                                   EQ ;
                                                                   AND ;
                                                                   OR ;
                                                                   PUSH nat 0 ;
                                                                   PUSH nat 2 ;
                                                                   { DIP { { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   EDIV ;
                                                                   IF_NONE { UNIT ;
                                                                             FAILWITH }
                                                                           { CDR @r } ;
                                                                   RENAME @x ;
                                                                   COMPARE ;
                                                                   EQ ;
                                                                   PUSH nat 1002 ;
                                                                   { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   COMPARE ;
                                                                   EQ ;
                                                                   AND ;
                                                                   OR ;
                                                                   PUSH nat 1 ;
                                                                   PUSH nat 2 ;
                                                                   { DIP { { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   EDIV ;
                                                                   IF_NONE { UNIT ;
                                                                             FAILWITH }
                                                                           { CDR @r } ;
                                                                   RENAME @x ;
                                                                   COMPARE ;
                                                                   EQ ;
                                                                   PUSH nat 1001 ;
                                                                   { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                   COMPARE ;
                                                                   EQ ;
                                                                   AND ;
                                                                   OR ;
                                                                   IF { PUSH nat 2 ;
                                                                        { DIP { DUP @bet } ; SWAP } ;
                                                                        MUL }
                                                                      { PUSH nat 24 ;
                                                                        { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                                        COMPARE ;
                                                                        GT ;
                                                                        PUSH nat 3003 ;
                                                                        { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        COMPARE ;
                                                                        EQ ;
                                                                        AND ;
                                                                        PUSH nat 25 ;
                                                                        { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        COMPARE ;
                                                                        LT ;
                                                                        PUSH nat 12 ;
                                                                        { DIP { { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        COMPARE ;
                                                                        GT ;
                                                                        AND ;
                                                                        PUSH nat 3020 ;
                                                                        { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        COMPARE ;
                                                                        EQ ;
                                                                        AND ;
                                                                        OR ;
                                                                        PUSH nat 13 ;
                                                                        { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        COMPARE ;
                                                                        LT ;
                                                                        PUSH nat 3100 ;
                                                                        { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                        COMPARE ;
                                                                        EQ ;
                                                                        AND ;
                                                                        OR ;
                                                                        IF { PUSH nat 3 ;
                                                                             { DIP { DUP @bet } ; SWAP } ;
                                                                             MUL }
                                                                           { PUSH nat 24 ;
                                                                             { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } ;
                                                                             COMPARE ;
                                                                             GT ;
                                                                             PUSH nat 13 ;
                                                                             { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             COMPARE ;
                                                                             LT ;
                                                                             OR ;
                                                                             PUSH nat 3103 ;
                                                                             { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             COMPARE ;
                                                                             EQ ;
                                                                             AND ;
                                                                             PUSH nat 12 ;
                                                                             { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             COMPARE ;
                                                                             GT ;
                                                                             PUSH nat 3023 ;
                                                                             { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             COMPARE ;
                                                                             EQ ;
                                                                             AND ;
                                                                             OR ;
                                                                             PUSH nat 25 ;
                                                                             { DIP { { DIP { { DIP { DUP @wn } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             COMPARE ;
                                                                             LT ;
                                                                             PUSH nat 3120 ;
                                                                             { DIP { { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                             COMPARE ;
                                                                             EQ ;
                                                                             AND ;
                                                                             OR ;
                                                                             IF { PUSH mumav 1000000 ;
                                                                                  PUSH nat 2 ;
                                                                                  { DIP { { DIP { { DIP { { DIP { DUP @bn } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                                                  EDIV ;
                                                                                  IF_NONE { UNIT ;
                                                                                            FAILWITH }
                                                                                          { CAR @r } ;
                                                                                  RENAME @x ;
                                                                                  MUL ;
                                                                                  { DIP { DUP @bet } ; SWAP } ;
                                                                                  ADD }
                                                                                { PUSH mumav 0 } } } } } ;
                                                         DIP { DROP ; DROP ; DROP ; DROP } ;
                                                         { DIP { { DIP { DUP @game } ; SWAP } } ; SWAP } ;
                                                         { CDR ; CDR ; CAR %player } ;
                                                         CONTRACT unit ;
                                                         IF_NONE { { DIP { { DIP { DUP @game } ; SWAP } } ; SWAP } ; { CDR ; CDR ; CAR %player } ; PUSH string "Cannot recover contract from:" ; PAIR ; FAILWITH } {} ;
                                                         RENAME @pi ;
                                                         PUSH mumav 0 ;
                                                         { DIP { { DIP { DUP @win_amount } ; SWAP } } ; SWAP } ;
                                                         COMPARE ;
                                                         EQ ;
                                                         IF { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              NIL operation ;
                                                              { DIP { { DIP { DUP @pi } ; SWAP } } ; SWAP } ;
                                                              PUSH mumav 1 ;
                                                              { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @win_number } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              MUL @winn ;
                                                              UNIT ;
                                                              TRANSFER_TOKENS ;
                                                              CONS ;
                                                              PUSH key_hash "tz1S78DjQtaiVU27fFrRuxCdzwJJoUJi4XfP" ;
                                                              IMPLICIT_ACCOUNT ;
                                                              PUSH mumav 10000 ;
                                                              PUSH mumav 1000000 ;
                                                              { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @win_amount } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              EDIV ;
                                                              IF_NONE { UNIT ;
                                                                        FAILWITH }
                                                                      { CAR } ;
                                                              RENAME @n ;
                                                              MUL @founder_cut ;
                                                              UNIT ;
                                                              TRANSFER_TOKENS ;
                                                              CONS ;
                                                              PAIR }
                                                            { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              CDR ;
                                                              NONE (pair :game (nat %betn) (pair (mumav %bet) (pair (address %player) (pair (timestamp %time) (mumav %win_amount))))) ;
                                                              PAIR @storage %game ;
                                                              DUP ;
                                                              CAR %game ;
                                                              SWAP ;
                                                              CDR ;
                                                              CDR ;
                                                              { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              CDR @next_win_hash ;
                                                              PAIR %next_win_number ;
                                                              SWAP ;
                                                              PAIR @storage %game ;
                                                              NIL operation ;
                                                              { DIP { { DIP { DUP @pi } ; SWAP } } ; SWAP } ;
                                                              PUSH mumav 1 ;
                                                              { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP @win_number } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              MUL ;
                                                              { DIP { { DIP { { DIP { { DIP { { DIP { DUP @win_amount } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              ADD ;
                                                              UNIT ;
                                                              TRANSFER_TOKENS ;
                                                              CONS @ops ;
                                                              PAIR } ;
                                                         DIP { DROP ; DROP ; DROP ; DROP } } ;
                                               DIP { DROP ; DROP ; DROP } }
                                             { IF_LEFT { RENAME @_oracle_hash_oracle_all_slash_75 ;
                                                         { DIP { { DIP { DUP @storage } ; SWAP } } ; SWAP } ;
                                                         { DIP { DUP } ; SWAP } ;
                                                         CAR @oracle_hash ;
                                                         { DIP { DUP @storage } ; SWAP } ;
                                                         { CDR ; CDR ; CAR %owner } ;
                                                         SENDER ;
                                                         COMPARE ;
                                                         NEQ ;
                                                         IF { PUSH string "Wrong owner" ;
                                                              FAILWITH }
                                                            { UNIT } ;
                                                         DROP ;
                                                         { DIP { DUP @storage } ; SWAP } ;
                                                         DUP ;
                                                         CAR %game ;
                                                         SWAP ;
                                                         CDR ;
                                                         DUP ;
                                                         CAR %next_win_number ;
                                                         SWAP ;
                                                         CDR ;
                                                         DUP ;
                                                         CAR %owner ;
                                                         SWAP ;
                                                         CDR ;
                                                         CAR %owner_started ;
                                                         { DIP { { DIP { { DIP { { DIP { { DIP { { DIP { DUP } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                         CDR @oracle_all ;
                                                         SWAP ;
                                                         PAIR %owner_started %oracle_for_all_bets ;
                                                         SWAP ;
                                                         PAIR %owner ;
                                                         SWAP ;
                                                         PAIR %next_win_number ;
                                                         SWAP ;
                                                         PAIR @storage %game ;
                                                         PUSH nat 0 ;
                                                         { DIP { { DIP { DUP @oracle_hash } ; SWAP } } ; SWAP } ;
                                                         SIZE ;
                                                         COMPARE ;
                                                         GT ;
                                                         IF { DUP @storage ;
                                                              DUP ;
                                                              CAR %game ;
                                                              SWAP ;
                                                              CDR ;
                                                              CDR ;
                                                              { DIP { { DIP { { DIP { DUP @oracle_hash } ; SWAP } } ; SWAP } } ; SWAP } ;
                                                              PAIR %next_win_number ;
                                                              SWAP ;
                                                              PAIR @storage %game ;
                                                              NIL operation ;
                                                              PAIR }
                                                            { DUP @storage ;
                                                              NIL operation ;
                                                              PAIR } ;
                                                         DIP { DROP ; DROP ; DROP ; DROP } }
                                                       { DROP ;
                                                         { DIP { DUP } ; SWAP } ;
                                                         NIL operation ;
                                                         PAIR } } } } } ;
       DIP { DROP ; DROP } }